import Foundation

class GameTimer {
    <% if @interval.nil? %>
    private let interval: TimeInterval = 600
    <% else %>
    private let interval: TimeInterval = <%= @interval %>
    <% end %>
    private let webGameController: WebGameController
    private let request: String = "<%=@request%>"
    
    private var timer: Timer?
    
    init(webGameController: WebGameController) {
        self.webGameController = webGameController
    }
    
    func start() {
        timer = Timer.scheduledTimer(
            timeInterval: interval,
            target: self,
            selector: #selector(tick),
            userInfo: nil,
            repeats: true
        )
    }
    
    deinit {
        timer?.invalidate()
    }

    @objc private func tick() {
        if let url = URL(string: "sandbox://\(request)") {
            webGameController.request(url: url)
        }
    }
}
